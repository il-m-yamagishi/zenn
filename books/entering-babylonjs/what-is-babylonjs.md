---
title: "Babylon.js とは"
---

## 自己紹介

初めまして。やまゆです。

皆さんはゲームはお好きですか？では自分でゲームを開発したことは？

私は、小学生の頃に [RPG ツクール 2000](https://rpgmakerofficial.com/product/products/rpg2000/index/) と出会い、その簡単なユーザーインターフェースとそこから生まれる **自分だけの RPG** に心打たれ、それから今までずっとゲームを作り続けています。

高校時代は C# を用いて DirectX 9 のアプリケーションを作れる [XNA Framework](https://ja.wikipedia.org/wiki/Microsoft_XNA) と呼ばれる Microsoft のフレームワークを使って 3D ゲームを作ろうとし挫折していました(あの頃は技術力が足りなかった)。このフレームワークは今は [MonoGame](https://monogame.net/) としてオープンソース化され、例えば [Mercenary Kings](https://mercenarykings.com/) や [CELESTE](https://www.celestegame.com/) のような有名ゲームでも採用されています。採用事例は [MonoGame Showcase](https://monogame.net/showcase/) に一覧されています。

<https://www.youtube.com/watch?v=qk0Q5609sXo>

ずいぶん昔の動画ですが、 XNA Framework と C# サーバーを用意してネットワークテストを行ったりしていました。

現在は主にソーシャルゲームのサーバーサイドを PHP を使って開発する会社に所属し、仕事でもゲームを作っています。

## Babylon.js とは？

さて、今回この本では Babylon.js と呼ばれる、ブラウザ 3D フレームワークの紹介をします。

<https://www.babylonjs.com/>

どんなことが出来るかは、上記公式ホームページのサンプルを見て頂くのが一番分かりやすいと思いますのでご覧ください。

[Physically Based Rendering(物理ベースのレンダリング)](https://ja.wikipedia.org/wiki/%E7%89%A9%E7%90%86%E3%83%99%E3%83%BC%E3%82%B9%E3%82%B7%E3%82%A7%E3%83%BC%E3%83%87%E3%82%A3%E3%83%B3%E3%82%B0) と [glTF 2.0(オープンソースの 3D アセット表現規格)](https://ja.wikipedia.org/wiki/GlTF#glTF_2.0) を強力にサポートする、ブラウザ上で動作する [WebGL 1.0/2.0](https://ja.wikipedia.org/wiki/WebGL), [WebGPU](https://ja.wikipedia.org/wiki/WebGPU) のラッパーフレームワークです。 Microsoft がコアチームとなって主にコントリビュートしているオープンソースのプロジェクトとなっています。

さて、様々なワードが出ましたので一つずつ紹介していきます。 **「とりあえず動くコードが書いてみたい！」** という方は、飛ばして次の章へ進んでいただいて構いません。

### Physically Based Rendering(PBR)

PBR とは、 3D モデルの材質(Material) を Metalness/Roughness などの **物理的なパラメーターを用いて描画する手法** です。パラメーターを調整することで写実的なレンダリングを行うことが出来るのが特徴となっています。

これまでのレンダリング手法は、 GPU の性能の制限などから疑似的に光の反射を表現するものが主流でした。ここ十年程度で GPU の性能が飛躍的に向上したため、より **写実的な表現** が出来るようになり、最も一般的に使われている手法が PBR です(具体的な Disney BRDF などのようなモデルの紹介は省略します)。

Babylon.js では PBR の再現力に特化していて、 `PBRMaterial` と呼ばれるクラスを用いて、簡単に写実的なレンダリングを行うことが出来るようになっています。

### glTF

glTF とは、 3D アセットを表現するオープンでポータビリティのある規格で、様々なフレームワークでサポートされています。執筆現在の最新バージョンは、 2017 年に制定された 2.0 で、 PBR のパラメータを含めることが出来ます。

glTF は json で記述された情報と、そこから参照されるテクスチャやメッシュなどのバイナリデータで構成されていて、データを並列で読み込めたり、 **バイナリ自体が GPU で扱う形式に合わせているため高速にロード出来るよう最適化** されています。

3D アセットをファイルとして表現する際に最もよく使われているのは `fbx` 形式または `obj` 形式となっていますが、今後はこの `glTF` 形式で配布されるアセットも増えていくのではないかと思います。

glTF 2.0 は extension(拡張) の機能があり、任意のデータを json やバイナリに加えることが出来るようになっています。例えば、 [VRM](https://vrm.dev/) と呼ばれる **「人間アバターのフォーマット」** が日本で誕生していますが、これは glTF 2.0 の extension として定義されています。 glTF 2.0 に対応しているフレームワークは、任意の拡張を追加することが大体出来るようになっているので、 VRM 拡張への対応が簡単に出来ます。

また、 glTF は 1 つの json と複数のバイナリファイルで構成されていますが、それらをまとめて一つのファイルにした `glb` という形式も存在します。

無料で利用できるモデリングツールの [Blender](https://www.blender.jp/) は、 [glTF での出力](https://docs.blender.org/manual/ja/dev/addons/import_export/scene_gltf2.html)に対応しています。

対抗の 3D アセット規格として、 Apple や Pixar が主となっている [USD](https://openusd.org/release/index.html) とよばれるものもあります。

Babylon.js では、コア機能とは別の拡張機能として glTF Loader を搭載していて、現在の規格に対応した glTF を読み込むことが可能です。

何故 `fbx` や `obj` ではなく新しく `glTF` や `USD` が生まれたのかというと、元々モデリングツール側で扱いやすいように作られたのが `fbx` や `obj` で、それらを利用するランタイム(動作環境)に最適化されたものではなかったため、とされています。 `glTF` や `USD` はランタイムに最適化されているので、 `fbx` や `obj` よりも高速に読み込み、表示することが出来るという部分と、オープンな規格なので実装や提案をしやすい土壌にあるということで、 **今後期待される規格** となっています。

### WebGL

WebGL は、 OpenGL と呼ばれる GPU を使って 3D レンダリングを行うオープンな規格を Chrome や Safari などのブラウザ上で共通して行うための規格です。

バージョン 1.0 とバージョン 2.0 がありますが、 2024 年現在バージョン 1.0 は deprecated(非推奨)となりつつあり、多くの WebGL アプリケーションはバージョン 2.0 を採用しています。

実際は OpenGL ES と呼ばれる、モバイルデバイス向けの規格がベースになっています。

3D レンダリングを行うためには **「シェーダー」** と呼ばれる、どのようにポリゴンを画面に表示するかを決める仕組みがありますが、 WebGL では GLSL と呼ばれるシェーダー言語を用いて記述します。シェーダーについては発展的な内容になるので、後半の章で紹介します。

Babylon.js ではバージョン 1.0, バージョン 2.0 どちらも対応していますが、デフォルトでは 2.0 が選択されるようになっています。

### WebGPU

WebGPU は、 WebGL で抽象化されていた GPU への命令部分を、より細かく制御出来るようにするために作られた比較的新しい規格です。

Vulkan, Metal, DirectX12 など最新の規格に基づいて考案されていて、 WebGL よりも **効率的に** レンダリングを行うことが出来ます。

「シェーダー」も新しく **WGSL** と呼ばれるシェーダー言語に置き換えられ、記法がかなり異なります。

Babylon.js ではバージョン 7 現在は、試験的に WebGPU の対応が行われていて、一部の機能が WebGPU でも使えるようになっています。まだブラウザ側で非対応のものもありますので、 2024 年現在ではターゲットとして使われるのは珍しいです。

## Babylon.js のバージョン戦略について

フレームワークのバージョン戦略については[こちらのドキュメント](https://doc.babylonjs.com/setup/frameworkPackages/frameworkVers)に記載されていますが、基本的に v7.1.0 のようなセマンティックバージョニングを意識した形となっていて、毎週木曜日にマイナーバージョン(v7.1.0 でいえば 1 の部分)の更新があります。これは最新のブランチを反映したバージョンとなっています。

Babylon.js の強みとして、 **「メジャーバージョンアップの時以外に破壊的変更を行わない」** 戦略となっているので、毎週のバージョンアップで「突然 API が変更になった」ということは基本的にありません(バグが混入する可能性はゼロではないです)。

現在はメジャーバージョン 7 がリリースされていて、例年では 4 月前後にメジャーバージョンのアップデートが行われます。つまり、 2025 年 4 月ごろにメジャーバージョン 8.0.0 がリリースされる予定です（ここは確定しているわけではありませんが、最近の傾向として）。

## 搭載機能

Babylon.js は PBR や glTF などオープンな規格に対応していることがわかりましたが、他にどんな機能があるのでしょうか？ゲームを作るにはどの機能をどうやって使えば良いのでしょうか？

実は、ドキュメントの[機能一覧](https://doc.babylonjs.com/features/featuresDeepDive)を見てわかる通り非常にたくさんの機能が実装されています。

これら全てを紹介するのは難しいので、この本では実際にゲームを作りながら、必要な機能を紹介していこうと思います。
